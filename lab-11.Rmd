---
title: "Lab 11 - Grading the professor, Pt. 2"
author: Hannah Crawley
date: 4/7/2025
output: github_document
---

## Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse) 
library(tidymodels)
library(openintro)
```
# Part 1
## Exercise 1

```{r exercise1}
m_bty <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ bty_avg, data = evals)
```

# Part 2
## Exercise 2
> Fit a linear model (one you have fit before): m_bty_gen, predicting average professor evaluation score based on average beauty rating (bty_avg) and gender. Write the linear model, and note the R2 and the adjusted R2.
 
```{r exercise2_code}
m_bty_gen <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ gender + bty_avg, data = evals)
```

## Exercise 3
> Interpret the slope and intercept of m_bty_gen in context of the data. 

```{r}
summary(m_bty_gen$fit)
```
Slope: 0.172 -- on average male professors score .172 points higher than females when beauty is controlled for 
Slope: 0.074 -- for every one point increase in beauty score increases by .074 when gender is controlled for 
  
## Exercise 4
> What percent of the variability in score is explained by the model m_bty_gen.

```{r}
summary(m_bty_gen$fit)$r.squared
```
R^2 = 0.0591 -- 5.91% of variability in score is explained by gender and beauty

## Exercise 5
> What is the equation of the line corresponding to just male professors?

Male professors: y = 3.747 + .172 = 3.919

## Exercise 6
> For two professors who received the same beauty rating, which gender tends to have the higher course evaluation score?

Male professors tend to have a higher course eval 

## Exercise 7
> How does the relationship between beauty and evaluation score vary between male and female professors?

On average males tend to score .172 more on average when beauty is controlled for 

## Exercise 8 
>How do the adjusted R2 values of m_bty_gen and m_bty compare? What does this tell us about how useful gender is in explaining the variability in evaluation scores when we already have information on the beauty score of the professor. 

```{r}
summary(m_bty$fit)$r.squared
summary(m_bty_gen$fit)$r.squared
```
R^2 = 0.0591 -- 5.91% of variability in score is explained by gender and beauty 
R^2 = 0.035 -- 3.5% of variability in score explained by beauty 

Gender contributes additional explained variance beyond beauty alone 

## Exercise 9
> Compare the slopes of bty_avg under the two models (m_bty and m_bty_gen). Has the addition of gender to the model changed the parameter estimate (slope) for bty_avg?

```{r}
summary(m_bty$fit)
summary(m_bty_gen$fit)
```
Beauty model bty slope: 0.067
Beauty and gender model bty slope: 0.074

Accounting for gender the slope of bty_avg increases - 1 point increase in beauty is a .074 point increase in score 

## Exercise 10
> Create a new model called m_bty_rank with gender removed and rank added in. Write the equation of the linear model and interpret the slopes and intercept in context of the data.

```{r}
m_bty_rank <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ rank + bty_avg, data = evals)
summary(m_bty_rank$fit)
```
Tenure track slope = -0.161 -- tenure track professors score lower than non-tenure track holding beauty constant 

Tenured slope = -0.126 -- tenured prof score lower than non-tenure track holding beauty constant  

Bty_avg slope = 0.068 -- controlling   rank there is a .068 increase in score for every 1 point in 

# Part 3: The search for the best model 
Going forward, only consider the following variables as potential predictors: rank, ethnicity, gender, language, age, cls_perc_eval, cls_did_eval, cls_students, cls_level, cls_profs, cls_credits, bty_avg.

## Exercise 11
> Which variable, on its own, would you expect to be the worst predictor of evaluation scores? Why? Hint: Think about which variable would you expect to not have any association with the professor’s score.

## Exercise 12
> Check your suspicions from the previous exercise. Include the model output for that variable in your response.

## Exercise 13
> Suppose you wanted to fit a full model with the variables listed above. If you are already going to include cls_perc_eval and cls_students, which variable should you not include as an additional predictor? Why?

## Exercise 14
> Fit a full model with all predictors listed above (except for the one you decided to exclude) in the previous question.

## Exercise 15
> Using backward-selection with adjusted R-squared as the selection criterion, determine the best model. You do not need to show all steps in your answer, just the output for the final model. Also, write out the linear model for predicting score based on the final model you settle on.

## Exercise 16
> Interpret the slopes of one numerical and one categorical predictor based on your final model.

## Exercise 17
> Based on your final model, describe the characteristics of a professor and course at University of Texas at Austin that would be associated with a high evaluation score.

## Exercise 18
> Would you be comfortable generalizing your conclusions to apply to professors generally (at any university)? Why or why not?






___________

## Exercise 1
> Visualize the distribution of score. Is the distribution skewed? What does that tell you about how students rate courses? Is this what you expected to see? Why, or why not? Include any summary statistics and visualizations you use in your response.

```{r}
ggplot(evals, aes(x = score)) +
  geom_histogram()
```

```{r}
ggplot(evals, aes(x = score)) +
  geom_boxplot()
```

```{r}
summary(evals$score)
```

- Distribution is skewed left meaning that many students are rating courses positively  
- I would expect ratings to be more evenly distributed or perhaps even negative since most students who do reviews are complaining  


```{r exercise1}
# Add your R code here
```

## Exercise 2
> Visualize and describe the relationship between score and the variable bty_avg, a professor’s average beauty rating. See the help page for the function at http://ggplot2.tidyverse.org/reference/index.html.

```{r}
ggplot(evals, aes(x = score, y = bty_avg)) +
  geom_point()
```

- Relationship between beauty and score of professor is slightly positive 

## Exercise 3 
> Replot the scatterplot from Exercise 3, but this time use geom_jitter()? What does “jitter” mean? What was misleading about the initial scatterplot?

```{r exercise3}
ggplot(evals, aes(x = score, y = bty_avg)) +
  geom_jitter()
```
- Jitter adds a small amount of random variation to each point making it easier to see points that potentially overlap  
- this spreads out the points to and makes the distribution look like there is less of a relationship, but still shows skew  
- the first plot is slightly misleading due to the overlap in points 

# Part 2: Linear Regression with a Numerical Predictor 

## Exercise 4 
> Let’s see if the apparent trend in the plot is something more than natural variation. Fit a linear model called m_bty to predict average professor evaluation score by average beauty rating (bty_avg). Based on the regression output, write the linear model.

```{r}
m_bty <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ bty_avg, data = evals)
```

```{r}
summary(m_bty$fit)
```
score(y^) = 3.88 + 0.067(bty_avg)

## Exercise 5 
> Replot your visualization from Exercise 3, and add the regression line to this plot in orange color. Turn off the shading for the uncertainty of the line.

```{r exercise5}
ggplot(evals, aes(x = bty_avg, y = score)) +
  geom_jitter() + 
  geom_smooth(method = "lm", color = "orange", se = FALSE) + 
  labs(title = "Hot or Not?", subtitle = "Teaching Eval v.s. Beauty", x = "Beauty Avg", y = "Eval Score" )
```


## Exercise 6 
> Interpret the slope of the linear model in context of the data.  

Formula: score(y^) = 3.88 + 0.067(bty_avg)

- Slope: for each additional point of beauty average teaching evaluation score is expected to be 0.067 higher on average  


## Exercise 7
>Interpret the intercept of the linear model in context of the data. Comment on whether or not the intercept makes sense in this context. 

- Intercept: For a beauty average of 0 the teaching eval score is expected to be 3.88 -- this intercept does not particularly make since in our context based on the scale presented ... and that the teachers can't be that horrible looking... someone "don't yuck someone else's yum" i guess...

## Exercise 8
> Determine the R^2 of the model and interpret it in context of the data.

```{r}
summary(m_bty$fit)$r.squared

```

- R^2 =  0.03502 -- 3.5% of the variance in the teaching eval score can be explained by avg beauty, not a whole lot 


# Part 3: Linear Regression with a Categorical Predictor 
## Exercise 9
> Fit a new linear model called m_gen to predict average professor evaluation score based on gender of the professor. Based on the regression output, write the linear model and interpret the slope and intercept in context of the data.

```{r}
m_gen <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ gender, data = evals)
```

```{r}
summary(m_gen$fit)
```
> Fit a new linear model called m_gen to predict average professor evaluation score based on gender of the professor. Based on the regression output, write the linear model and interpret the slope and intercept in context of the data.

Equation: score = 4.09 + .14 (gender) where 0 = female and 1 = male   
- intercept = 4.09 -- on average a female professors score is  4.09  
- slope = .14 -- reflects the change in sex from male to female therefore on average the score for male professors is ~ 4.23


## Exercise 10 
> What is the equation of the line corresponding to male professors? What is it for female professors?  

- y(hat) = 4.09 -- female   
- y(hat) = 4.09 + .14 -- male 

## Exercise 11
> Fit a new linear model called m_rank to predict average professor evaluation score based on rank of the professor. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data.

```{r}
m_rank <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ rank, data = evals)
```

```{r}
summary(m_rank$fit)
```
For tenured track prof
Equation: y(hat) = 4.28 - .13(track)

 - for prof not on tenure track their score is 4.28 on average (intercept)
 - for prof on the tenure track their score is 4.15 on average - slope suggests eval goes down .13 when on track to tenure 


For tenured prof
Equation: y(hat) = 4.28 - .15(tenure)

- for prof that have tenure their score is 4.13 on average - once they have tenure the slope suggest their scores go down 


## Exercise 12
> For Exercise 12, the `relevel()` function can be helpful!
Create a new variable called rank_relevel where "tenure track" is the baseline level.

```{r}
evals_relvl <- relevel(evals$rank, ref = "tenure track")

```

## Exercise 13
> Fit a new linear model called m_rank_relevel to predict average professor evaluation score based on rank_relevel of the professor. This is the new (releveled) variable you created in Exercise 13. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data. Also determine and interpret the R^2 of the model.


```{r}
m_rank_relevel <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ evals_relvl, data = evals)
```

```{r}
summary(m_rank_relevel$fit)
```
Equation: y(hat) = 4.15 + (coeff x rankdummy)

- Tenure track: y hat = 4.15 -- they are the reference group that the intercept pertains to  

- Teaching: y hat = 4.15 + .13 = 4.28 -- slope of .13 shows an increase in score if they are in the teaching group  

- Tenured: y hat = 4.15 - .02 = 4.13 -- slope of -.02 shows a decrease in score if teachers are tenured 

R^2 = 0.01163 meaning 1.16% of variance is attributable to group

## Exercise 14
> Create another new variable called tenure_eligible that labels "teaching" faculty as "no" and labels "tenure track" and "tenured" faculty as "yes". 

```{r}
elig <- evals %>%  
  mutate(tenure_elig = ifelse(rank %in% c("tenure track", "tenured"), "yes", "no"))
```


## Exercise 15
> Fit a new linear model called m_tenure_eligible to predict average professor evaluation score based on tenure_eligibleness of the professor. This is the new (regrouped) variable you created in Exercise 15. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data. Also determine and interpret the R^2 of the model.


```{r}
m_tenure_elig <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ tenure_elig, data = elig)
```

```{r}
summary(m_tenure_elig$fit)
```
Equation: y(hat) = 4.28 + (coeff x elig)


- Teaching: y hat = 4.28 - intercept with teaching group being the reference
- Tenured: y hat = 4.28 - .14 = 4.14 -- slope of -.14 shows a decrease for teachers in the tenure eligible category 

R^2 = 0.0115 meaning 1.12% of variance is attributable to eligibility in rating 

